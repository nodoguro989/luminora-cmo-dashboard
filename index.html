<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Luminora CMO Dashboard â€” Candice</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        lum: { 50:'#faf9f7', 100:'#f0eeea', 200:'#e0dcd5', 300:'#c4bfb4', 400:'#a39c8e', 500:'#87806f', 600:'#6b6556', 700:'#504c41', 800:'#38352e', 900:'#22201c', 950:'#141310' },
        accent: { DEFAULT:'#8b7355', light:'#a68e6f', dark:'#6b5a42' },
      },
    }
  }
}
</script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
  body { font-family: 'Inter', sans-serif; }
  .vtab { transition: all 0.15s ease; border-left: 3px solid transparent; }
  .vtab:hover { background: #f0eeea; }
  .vtab.active { background: #f0eeea; border-left-color: #8b7355; color: #22201c; font-weight: 600; }
  .htab { transition: all 0.15s ease; border-bottom: 2px solid transparent; }
  .htab:hover { color: #6b6556; }
  .htab.active { border-bottom-color: #8b7355; color: #8b7355; font-weight: 600; }
  .segtab { transition: all 0.15s ease; border-bottom: 2px solid transparent; }
  .segtab:hover { color: #6b6556; }
  .segtab.active { font-weight: 600; }
  .segtab.active.seg-progress { border-bottom-color: #5b8a4a; color: #5b8a4a; }
  .segtab.active.seg-analysis { border-bottom-color: #b08040; color: #b08040; }
  .modal-overlay { background: rgba(20,19,16,0.5); backdrop-filter: blur(4px); }
  .screenshot-thumb { width: 72px; height: 72px; object-fit: cover; border-radius: 6px; }
  ::-webkit-scrollbar { width: 5px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: #c4bfb4; border-radius: 3px; }
</style>
</head>
<body class="bg-lum-50 text-lum-900 h-screen flex flex-col overflow-hidden">

<!-- Header -->
<header class="bg-white border-b border-lum-200 flex-shrink-0">
  <div class="px-6 py-3 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <div class="w-7 h-7 bg-lum-900 rounded-lg flex items-center justify-center text-white text-xs font-bold">L</div>
      <div>
        <h1 class="text-sm font-semibold text-lum-900">Luminora CMO Dashboard</h1>
        <p class="text-[10px] text-lum-400">Candice Â· Marketing Operations</p>
      </div>
    </div>
    <div class="flex items-center gap-3">
      <span id="lastUpdated" class="text-[10px] text-lum-400"></span>
      <button onclick="exportData()" class="text-[11px] px-2.5 py-1 bg-lum-100 rounded text-lum-600 hover:bg-lum-200 transition">Export</button>
    </div>
  </div>
</header>

<!-- Main Layout -->
<div class="flex flex-1 overflow-hidden">

  <!-- Vertical Tabs (Left Sidebar) -->
  <nav class="w-48 flex-shrink-0 bg-white border-r border-lum-100 flex flex-col py-2">
    <button onclick="setCategory('app')" id="vtab-app" class="vtab text-left px-4 py-2.5 text-sm text-lum-600 flex items-center gap-2.5 active">
      <span class="text-base">ðŸ“±</span><span>App Content</span>
    </button>
    <button onclick="setCategory('candice')" id="vtab-candice" class="vtab text-left px-4 py-2.5 text-sm text-lum-600 flex items-center gap-2.5">
      <span class="text-base">ðŸŒ¸</span><span>Candice Personal</span>
    </button>
    <div class="h-px bg-lum-100 my-1.5 mx-3"></div>
    <button onclick="setCategory('outreach-journal')" id="vtab-outreach-journal" class="vtab text-left px-4 py-2.5 text-sm text-lum-600 flex items-center gap-2.5">
      <span class="text-base">ðŸ“§</span><span>Outreach & Journal</span>
    </button>
    <div class="flex-1"></div>
  </nav>

  <!-- Content Area -->
  <div class="flex-1 flex flex-col overflow-hidden">

    <!-- Horizontal Sub-tabs (Platform tabs) -->
    <div id="hTabBar" class="bg-white border-b border-lum-100 px-6 flex gap-1 flex-shrink-0" style="display:none;">
    </div>

    <!-- Strategy Panel (horizontal overview) -->
    <div id="strategyPanel" class="bg-white border-b border-lum-100 flex-shrink-0" style="display:none;">
    </div>

    <!-- Segment Tabs (Progress Log / Analysis) -->
    <div id="segTabBar" class="bg-lum-50 border-b border-lum-100 px-6 flex gap-1 flex-shrink-0" style="display:none;">
    </div>

    <!-- Scrollable Content -->
    <div id="mainContent" class="flex-1 overflow-y-auto px-6 py-5">
    </div>

  </div>
</div>

<!-- Add Entry Modal -->
<div id="addModal" class="fixed inset-0 modal-overlay z-50 hidden flex items-center justify-center p-4">
  <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[85vh] overflow-y-auto">
    <div class="p-6">
      <div class="flex justify-between items-center mb-5">
        <h3 class="text-base font-semibold" id="modalTitle">Add Entry</h3>
        <button onclick="closeModal()" class="text-lum-400 hover:text-lum-600 text-xl">&times;</button>
      </div>
      <form id="entryForm" onsubmit="saveEntry(event)">
        <input type="hidden" id="entryEngine" />
        <input type="hidden" id="entrySegment" />
        <div class="space-y-3">
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Date</label>
            <input type="date" id="entryDate" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" required />
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Title</label>
            <input type="text" id="entryTitle" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="What was done?" required />
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Details</label>
            <textarea id="entryDetails" rows="3" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="Notes, observations, links..."></textarea>
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Screenshot URL (optional)</label>
            <input type="text" id="entryScreenshot" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="https://..." />
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Status</label>
            <select id="entryStatus" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent">
              <option value="done">âœ… Done</option>
              <option value="in-progress">ðŸ”„ In Progress</option>
              <option value="planned">ðŸ“‹ Planned</option>
              <option value="blocked">ðŸš« Blocked</option>
            </select>
          </div>
        </div>
        <div class="mt-5 flex gap-3 justify-end">
          <button type="button" onclick="closeModal()" class="px-4 py-2 text-sm text-lum-600 hover:text-lum-800">Cancel</button>
          <button type="submit" class="px-4 py-2 text-sm bg-accent text-white rounded-lg hover:bg-accent-dark transition">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Strategy Edit Modal -->
<div id="strategyModal" class="fixed inset-0 modal-overlay z-50 hidden flex items-center justify-center p-4">
  <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[85vh] overflow-y-auto">
    <div class="p-6">
      <div class="flex justify-between items-center mb-5">
        <h3 class="text-base font-semibold" id="strategyModalTitle">Edit Strategy</h3>
        <button onclick="closeStrategyModal()" class="text-lum-400 hover:text-lum-600 text-xl">&times;</button>
      </div>
      <form id="strategyForm" onsubmit="saveStrategy(event)">
        <input type="hidden" id="stratEngine" />
        <div class="space-y-3">
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Posting Frequency</label>
            <input type="text" id="stratFrequency" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="e.g. 5x/week" />
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">KPIs</label>
            <textarea id="stratKPIs" rows="2" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="One KPI per line..."></textarea>
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Content Pillars</label>
            <textarea id="stratPillars" rows="2" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="Key content themes..."></textarea>
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Target Audience</label>
            <textarea id="stratAudience" rows="2" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="Who are we reaching?"></textarea>
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Notes</label>
            <textarea id="stratNotes" rows="2" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="Additional notes..."></textarea>
          </div>
        </div>
        <div class="mt-5 flex gap-3 justify-end">
          <button type="button" onclick="closeStrategyModal()" class="px-4 py-2 text-sm text-lum-600 hover:text-lum-800">Cancel</button>
          <button type="submit" class="px-4 py-2 text-sm bg-accent text-white rounded-lg hover:bg-accent-dark transition">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// â”€â”€â”€ Data Model â”€â”€â”€
const CATEGORIES = [
  { id:'app', name:'App Content', emoji:'ðŸ“±', platforms:[
    { id:'app-ig', name:'Instagram & Meta', emoji:'ðŸ“¸' },
    { id:'app-tt', name:'TikTok', emoji:'ðŸŽµ' },
    { id:'app-red', name:'å°çº¢ä¹¦', emoji:'ðŸ“•' },
  ]},
  { id:'candice', name:'Candice Personal', emoji:'ðŸŒ¸', platforms:[
    { id:'candice-ig', name:'Instagram', emoji:'ðŸ“¸' },
    { id:'candice-tt', name:'TikTok', emoji:'ðŸŽµ' },
    { id:'candice-red', name:'å°çº¢ä¹¦', emoji:'ðŸ“•' },
  ]},
  { id:'outreach-journal', name:'Outreach & Journal', emoji:'ðŸ“§', platforms:[
    { id:'outreach', name:'Outreach', emoji:'ðŸ“§' },
    { id:'journal', name:'Journal / SEO', emoji:'ðŸ“' },
  ]},
];

const ALL_ENGINES = CATEGORIES.flatMap(c => c.platforms);

function defaultData() {
  const d = { strategies:{}, progress:{}, analysis:{}, lastUpdated: new Date().toISOString() };
  ALL_ENGINES.forEach(e => {
    d.strategies[e.id] = { frequency:'', kpis:'', pillars:'', audience:'', notes:'' };
    d.progress[e.id] = [];
    d.analysis[e.id] = [];
  });
  return d;
}

let DATA = JSON.parse(localStorage.getItem('luminora-cmo') || 'null') || defaultData();
// Migrate: ensure all engine keys exist
ALL_ENGINES.forEach(e => {
  if(!DATA.strategies[e.id]) DATA.strategies[e.id] = { frequency:'', kpis:'', pillars:'', audience:'', notes:'' };
  if(!DATA.progress[e.id]) DATA.progress[e.id] = [];
  if(!DATA.analysis[e.id]) DATA.analysis[e.id] = [];
});

let currentCategory = 'app';
let currentPlatform = 'app-ig';
let currentSegment = 'progress'; // 'progress' or 'analysis'

function save() {
  DATA.lastUpdated = new Date().toISOString();
  localStorage.setItem('luminora-cmo', JSON.stringify(DATA));
  document.getElementById('lastUpdated').textContent = 'Saved ' + new Date().toLocaleTimeString();
}

// â”€â”€â”€ Navigation â”€â”€â”€
function setCategory(catId) {
  currentCategory = catId;
  // Reset platform to first in category
  const cat = CATEGORIES.find(c => c.id === catId);
  currentPlatform = cat ? cat.platforms[0].id : null;
  currentSegment = 'progress';
  updateVTabs();
  render();
}

function setPlatform(platId) {
  currentPlatform = platId;
  currentSegment = 'progress';
  updateHTabs();
  render();
}

function setSegment(seg) {
  currentSegment = seg;
  updateSegTabs();
  renderContent();
}

function updateVTabs() {
  document.querySelectorAll('.vtab').forEach(b => b.classList.remove('active'));
  const el = document.getElementById('vtab-'+currentCategory);
  if(el) el.classList.add('active');
}

function updateHTabs() {
  document.querySelectorAll('.htab').forEach(b => b.classList.remove('active'));
  const el = document.getElementById('htab-'+currentPlatform);
  if(el) el.classList.add('active');
}

function updateSegTabs() {
  document.querySelectorAll('.segtab').forEach(b => b.classList.remove('active'));
  const el = document.getElementById('segtab-'+currentSegment);
  if(el) el.classList.add('active');
}

// â”€â”€â”€ Render â”€â”€â”€
function render() {
  const hBar = document.getElementById('hTabBar');
  const stratPanel = document.getElementById('strategyPanel');
  const segBar = document.getElementById('segTabBar');
  const main = document.getElementById('mainContent');

  const cat = CATEGORIES.find(c => c.id === currentCategory);
  if(!cat) return;

  // Horizontal platform tabs
  hBar.style.display = 'flex';
  hBar.innerHTML = cat.platforms.map(p =>
    `<button onclick="setPlatform('${p.id}')" id="htab-${p.id}" class="htab px-4 py-2.5 text-sm text-lum-500 whitespace-nowrap flex items-center gap-1.5 ${p.id === currentPlatform ? 'active' : ''}">
      <span>${p.emoji}</span> ${p.name}
    </button>`
  ).join('');

  // Strategy panel
  renderStrategyPanel(stratPanel);

  // Segment tabs
  segBar.style.display = 'flex';
  segBar.innerHTML = `
    <button onclick="setSegment('progress')" id="segtab-progress" class="segtab seg-progress px-4 py-2 text-sm text-lum-500 flex items-center gap-1.5 ${currentSegment==='progress' ? 'active' : ''}">
      ðŸ“‹ Progress Log
    </button>
    <button onclick="setSegment('analysis')" id="segtab-analysis" class="segtab seg-analysis px-4 py-2 text-sm text-lum-500 flex items-center gap-1.5 ${currentSegment==='analysis' ? 'active' : ''}">
      ðŸ’¡ Analysis
    </button>
    <div class="flex-1"></div>
    <button onclick="openAddEntry('${currentPlatform}','${currentSegment}')" class="px-3 py-1 my-1 text-[11px] bg-accent text-white rounded hover:bg-accent-dark transition">
      + ${currentSegment === 'analysis' ? 'Analysis' : 'Entry'}
    </button>
  `;

  renderContent();
}

function renderStrategyPanel(el) {
  const strat = DATA.strategies[currentPlatform] || {};
  const hasContent = strat.frequency || strat.kpis || strat.pillars || strat.audience;
  el.style.display = 'block';

  if(!hasContent) {
    el.innerHTML = `<div class="px-6 py-3 flex items-center justify-between">
      <span class="text-xs text-lum-400 italic">No strategy set yet</span>
      <button onclick="openStrategyEdit('${currentPlatform}')" class="text-[11px] text-accent hover:text-accent-dark transition font-medium">+ Set Strategy</button>
    </div>`;
    return;
  }

  el.innerHTML = `<div class="px-6 py-3">
    <div class="flex items-center justify-between mb-2">
      <span class="text-[10px] font-semibold uppercase tracking-wider text-lum-400">Strategy</span>
      <button onclick="openStrategyEdit('${currentPlatform}')" class="text-[11px] text-accent hover:text-accent-dark transition">Edit</button>
    </div>
    <div class="grid grid-cols-4 gap-4 text-xs">
      <div>
        <span class="text-[10px] text-lum-400 block">Frequency</span>
        <span class="text-lum-800">${strat.frequency || 'â€”'}</span>
      </div>
      <div>
        <span class="text-[10px] text-lum-400 block">KPIs</span>
        <span class="text-lum-800 whitespace-pre-line">${strat.kpis || 'â€”'}</span>
      </div>
      <div>
        <span class="text-[10px] text-lum-400 block">Content Pillars</span>
        <span class="text-lum-800 whitespace-pre-line">${strat.pillars || 'â€”'}</span>
      </div>
      <div>
        <span class="text-[10px] text-lum-400 block">Audience</span>
        <span class="text-lum-800 whitespace-pre-line">${strat.audience || 'â€”'}</span>
      </div>
    </div>
    ${strat.notes ? `<div class="mt-2 pt-2 border-t border-lum-50 text-[11px] text-lum-500">${strat.notes}</div>` : ''}
  </div>`;
}

function renderContent() {
  const main = document.getElementById('mainContent');
  const entries = currentSegment === 'progress'
    ? (DATA.progress[currentPlatform] || [])
    : (DATA.analysis[currentPlatform] || []);

  if(entries.length === 0) {
    main.innerHTML = `<div class="flex flex-col items-center justify-center h-full text-center">
      <div class="text-4xl mb-3">${currentSegment === 'progress' ? 'ðŸ“‹' : 'ðŸ’¡'}</div>
      <p class="text-sm text-lum-400">No ${currentSegment === 'progress' ? 'progress entries' : 'analyses'} yet.</p>
      <button onclick="openAddEntry('${currentPlatform}','${currentSegment}')" class="mt-3 px-4 py-2 text-xs bg-accent text-white rounded-lg hover:bg-accent-dark transition">
        Add ${currentSegment === 'progress' ? 'First Entry' : 'First Analysis'}
      </button>
    </div>`;
    return;
  }

  const statusColors = { done:'bg-green-100 text-green-700', 'in-progress':'bg-yellow-100 text-yellow-700', planned:'bg-blue-100 text-blue-700', blocked:'bg-red-100 text-red-700' };
  const statusLabels = { done:'Done', 'in-progress':'In Progress', planned:'Planned', blocked:'Blocked' };

  let html = '<div class="space-y-2.5">';
  entries.forEach((entry, i) => {
    html += `<div class="flex gap-3 p-3 rounded-lg bg-white border border-lum-100 group hover:border-lum-200 transition">
      ${entry.screenshot ? `<img src="${entry.screenshot}" class="screenshot-thumb flex-shrink-0" onerror="this.style.display='none'" />` : ''}
      <div class="flex-1 min-w-0">
        <div class="flex items-center gap-2 mb-1">
          ${currentSegment === 'progress' ? `<span class="text-[10px] px-1.5 py-0.5 rounded-full ${statusColors[entry.status] || statusColors.done}">${statusLabels[entry.status] || entry.status}</span>` : ''}
          <span class="text-[10px] text-lum-400">${entry.date}</span>
          <button onclick="deleteEntry('${currentPlatform}','${currentSegment}',${i})" class="text-[10px] text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition ml-auto">âœ•</button>
        </div>
        <h4 class="text-sm font-medium text-lum-800 leading-snug">${entry.title}</h4>
        ${entry.details ? `<p class="text-[11px] text-lum-500 mt-1 whitespace-pre-line leading-relaxed">${entry.details}</p>` : ''}
      </div>
    </div>`;
  });
  html += '</div>';
  main.innerHTML = html;
}

// â”€â”€â”€ Modals â”€â”€â”€
function openAddEntry(engineId, segment) {
  document.getElementById('entryEngine').value = engineId;
  document.getElementById('entrySegment').value = segment;
  document.getElementById('entryDate').value = new Date().toISOString().split('T')[0];
  document.getElementById('entryTitle').value = '';
  document.getElementById('entryDetails').value = '';
  document.getElementById('entryScreenshot').value = '';
  document.getElementById('entryStatus').value = 'done';
  document.getElementById('modalTitle').textContent = segment === 'analysis' ? 'Add Analysis' : 'Add Progress Entry';
  document.getElementById('addModal').classList.remove('hidden');
}
function closeModal() { document.getElementById('addModal').classList.add('hidden'); }

function saveEntry(e) {
  e.preventDefault();
  const engineId = document.getElementById('entryEngine').value;
  const segment = document.getElementById('entrySegment').value;
  const entry = {
    date: document.getElementById('entryDate').value,
    title: document.getElementById('entryTitle').value,
    details: document.getElementById('entryDetails').value,
    screenshot: document.getElementById('entryScreenshot').value,
    status: document.getElementById('entryStatus').value,
    createdAt: new Date().toISOString()
  };
  if(segment === 'progress') { if(!DATA.progress[engineId]) DATA.progress[engineId]=[]; DATA.progress[engineId].unshift(entry); }
  else { if(!DATA.analysis[engineId]) DATA.analysis[engineId]=[]; DATA.analysis[engineId].unshift(entry); }
  save(); closeModal(); render();
}

function deleteEntry(engineId, segment, index) {
  if(!confirm('Delete this entry?')) return;
  if(segment === 'progress') DATA.progress[engineId].splice(index, 1);
  else DATA.analysis[engineId].splice(index, 1);
  save(); render();
}

function openStrategyEdit(engineId) {
  const strat = DATA.strategies[engineId] || {};
  document.getElementById('stratEngine').value = engineId;
  document.getElementById('stratFrequency').value = strat.frequency || '';
  document.getElementById('stratKPIs').value = strat.kpis || '';
  document.getElementById('stratPillars').value = strat.pillars || '';
  document.getElementById('stratAudience').value = strat.audience || '';
  document.getElementById('stratNotes').value = strat.notes || '';
  const plat = ALL_ENGINES.find(e => e.id === engineId);
  document.getElementById('strategyModalTitle').textContent = `Strategy Â· ${plat?.name || engineId}`;
  document.getElementById('strategyModal').classList.remove('hidden');
}
function closeStrategyModal() { document.getElementById('strategyModal').classList.add('hidden'); }

function saveStrategy(e) {
  e.preventDefault();
  const engineId = document.getElementById('stratEngine').value;
  DATA.strategies[engineId] = {
    frequency: document.getElementById('stratFrequency').value,
    kpis: document.getElementById('stratKPIs').value,
    pillars: document.getElementById('stratPillars').value,
    audience: document.getElementById('stratAudience').value,
    notes: document.getElementById('stratNotes').value
  };
  save(); closeStrategyModal(); render();
}

function exportData() {
  const blob = new Blob([JSON.stringify(DATA, null, 2)], { type:'application/json' });
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
  a.download = `luminora-cmo-${new Date().toISOString().split('T')[0]}.json`; a.click();
}

// â”€â”€â”€ Init â”€â”€â”€
render();
if(DATA.lastUpdated) document.getElementById('lastUpdated').textContent = 'Last saved ' + new Date(DATA.lastUpdated).toLocaleString();
</script>
</body>
</html>
