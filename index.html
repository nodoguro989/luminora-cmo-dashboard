<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Luminora CMO Dashboard â€” Candice</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        lum: { 50:'#faf8f8', 100:'#f2eeee', 200:'#e3dcd9', 300:'#c4b8b4', 400:'#a3928e', 500:'#7a6560', 600:'#5c4540', 700:'#45302b', 800:'#2e1c18', 900:'#1e0e0a', 950:'#120805' },
        accent: { DEFAULT:'#7a2e2e', light:'#9b4a4a', dark:'#5a1e1e' },
      },
    }
  }
}
</script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
  body { font-family: 'Inter', sans-serif; }
  .vtab { transition: all 0.15s ease; border-left: 3px solid transparent; }
  .vtab:hover { background: #f0eeea; }
  .vtab.active { background: #f2eeee; border-left-color: #7a2e2e; color: #1e0e0a; font-weight: 600; }
  .htab { transition: all 0.15s ease; border-bottom: 2px solid transparent; }
  .htab:hover { color: #45302b; }
  .htab.active { border-bottom-color: #7a2e2e; color: #7a2e2e; font-weight: 600; }
  .segtab { transition: all 0.15s ease; border-bottom: 2px solid transparent; }
  .segtab:hover { color: #45302b; }
  .segtab.active { font-weight: 600; }
  .segtab.active.seg-drafts { border-bottom-color: #2e5a7a; color: #2e5a7a; }
  .segtab.active.seg-progress { border-bottom-color: #4a7a3a; color: #4a7a3a; }
  .segtab.active.seg-analysis { border-bottom-color: #7a2e2e; color: #7a2e2e; }
  .modal-overlay { background: rgba(20,19,16,0.5); backdrop-filter: blur(4px); }
  .screenshot-thumb { width: 72px; height: 72px; object-fit: cover; border-radius: 6px; }
  ::-webkit-scrollbar { width: 5px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: #c4b8b4; border-radius: 3px; }
</style>
</head>
<body class="bg-lum-50 text-lum-900 h-screen flex flex-col overflow-hidden">

<!-- Header -->
<header class="bg-white border-b border-lum-200 flex-shrink-0">
  <div class="px-6 py-3 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <div class="w-7 h-7 bg-lum-900 rounded-lg flex items-center justify-center text-white text-xs font-bold">L</div>
      <div>
        <h1 class="text-sm font-semibold text-lum-900">Luminora CMO Dashboard</h1>
        <p class="text-[10px] text-lum-400">Candice Â· Marketing Operations</p>
      </div>
    </div>
    <div class="flex items-center gap-3">
      <span id="lastUpdated" class="text-[10px] text-lum-400"></span>
      <button onclick="exportData()" class="text-[11px] px-2.5 py-1 bg-lum-100 rounded text-lum-600 hover:bg-lum-200 transition">Export</button>
    </div>
  </div>
</header>

<!-- Main Layout -->
<div class="flex flex-1 overflow-hidden">

  <!-- Vertical Tabs (Left Sidebar) -->
  <nav class="w-48 flex-shrink-0 bg-white border-r border-lum-100 flex flex-col py-2">
    <button onclick="setCategory('app')" id="vtab-app" class="vtab text-left px-4 py-2.5 text-sm text-lum-600 flex items-center gap-2.5 active">
      <span class="text-base">ğŸ“±</span><span>App Content</span>
    </button>
    <button onclick="setCategory('candice')" id="vtab-candice" class="vtab text-left px-4 py-2.5 text-sm text-lum-600 flex items-center gap-2.5">
      <span class="text-base">ğŸŒ¸</span><span>Candice Personal</span>
    </button>
    <div class="h-px bg-lum-100 my-1.5 mx-3"></div>
    <button onclick="setCategory('outreach-journal')" id="vtab-outreach-journal" class="vtab text-left px-4 py-2.5 text-sm text-lum-600 flex items-center gap-2.5">
      <span class="text-base">ğŸ“§</span><span>Outreach & Journal</span>
    </button>
    <div class="flex-1"></div>
  </nav>

  <!-- Content Area -->
  <div class="flex-1 flex flex-col overflow-hidden">

    <!-- Horizontal Sub-tabs (Platform tabs) -->
    <div id="hTabBar" class="bg-white border-b border-lum-100 px-6 flex gap-1 flex-shrink-0" style="display:none;">
    </div>

    <!-- Strategy Panel (horizontal overview) -->
    <div id="strategyPanel" class="bg-white border-b border-lum-100 flex-shrink-0" style="display:none;">
    </div>

    <!-- Segment Tabs (Progress Log / Analysis) -->
    <div id="segTabBar" class="bg-lum-50 border-b border-lum-100 px-6 flex gap-1 flex-shrink-0" style="display:none;">
    </div>

    <!-- Scrollable Content -->
    <div id="mainContent" class="flex-1 overflow-y-auto px-6 py-5">
    </div>

  </div>
</div>

<!-- Add Entry Modal -->
<div id="addModal" class="fixed inset-0 modal-overlay z-50 hidden flex items-center justify-center p-4">
  <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[85vh] overflow-y-auto">
    <div class="p-6">
      <div class="flex justify-between items-center mb-5">
        <h3 class="text-base font-semibold" id="modalTitle">Add Entry</h3>
        <button onclick="closeModal()" class="text-lum-400 hover:text-lum-600 text-xl">&times;</button>
      </div>
      <form id="entryForm" onsubmit="saveEntry(event)">
        <input type="hidden" id="entryEngine" />
        <input type="hidden" id="entrySegment" />
        <div class="space-y-3">
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Date</label>
            <input type="date" id="entryDate" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" required />
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Title</label>
            <input type="text" id="entryTitle" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="What was done?" required />
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Details</label>
            <textarea id="entryDetails" rows="3" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="Notes, observations, links..."></textarea>
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Screenshot URL (optional)</label>
            <input type="text" id="entryScreenshot" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="https://..." />
          </div>
          <div id="statusRow">
            <label class="block text-xs font-medium text-lum-600 mb-1">Status</label>
            <select id="entryStatus" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent">
              <option value="done">âœ… Done</option>
              <option value="in-progress">ğŸ”„ In Progress</option>
              <option value="planned">ğŸ“‹ Planned</option>
              <option value="blocked">ğŸš« Blocked</option>
            </select>
          </div>
        </div>
        <div class="mt-5 flex gap-3 justify-end">
          <button type="button" onclick="closeModal()" class="px-4 py-2 text-sm text-lum-600 hover:text-lum-800">Cancel</button>
          <button type="submit" class="px-4 py-2 text-sm bg-accent text-white rounded-lg hover:bg-accent-dark transition">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Strategy Edit Modal -->
<div id="strategyModal" class="fixed inset-0 modal-overlay z-50 hidden flex items-center justify-center p-4">
  <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[85vh] overflow-y-auto">
    <div class="p-6">
      <div class="flex justify-between items-center mb-5">
        <h3 class="text-base font-semibold" id="strategyModalTitle">Edit Strategy</h3>
        <button onclick="closeStrategyModal()" class="text-lum-400 hover:text-lum-600 text-xl">&times;</button>
      </div>
      <form id="strategyForm" onsubmit="saveStrategy(event)">
        <input type="hidden" id="stratEngine" />
        <div class="space-y-3">
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Posting Frequency</label>
            <input type="text" id="stratFrequency" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="e.g. 5x/week" />
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">KPIs</label>
            <textarea id="stratKPIs" rows="2" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="One KPI per line..."></textarea>
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Content Pillars</label>
            <textarea id="stratPillars" rows="2" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="Key content themes..."></textarea>
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Target Audience</label>
            <textarea id="stratAudience" rows="2" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="Who are we reaching?"></textarea>
          </div>
          <div>
            <label class="block text-xs font-medium text-lum-600 mb-1">Notes</label>
            <textarea id="stratNotes" rows="2" class="w-full border border-lum-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent" placeholder="Additional notes..."></textarea>
          </div>
        </div>
        <div class="mt-5 flex gap-3 justify-end">
          <button type="button" onclick="closeStrategyModal()" class="px-4 py-2 text-sm text-lum-600 hover:text-lum-800">Cancel</button>
          <button type="submit" class="px-4 py-2 text-sm bg-accent text-white rounded-lg hover:bg-accent-dark transition">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// â”€â”€â”€ Data Model â”€â”€â”€
const CATEGORIES = [
  { id:'app', name:'App Content', emoji:'ğŸ“±', platforms:[
    { id:'app-ig-frases', name:'@frasesdiarias', emoji:'ğŸ“¸' },
    { id:'app-ig-calm', name:'@daily_cup_of_calm', emoji:'ğŸ“¸' },
    { id:'app-tt', name:'TikTok', emoji:'ğŸµ' },
    { id:'app-red', name:'å°çº¢ä¹¦', emoji:'ğŸ“•' },
  ]},
  { id:'candice', name:'Candice Personal', emoji:'ğŸŒ¸', platforms:[
    { id:'candice-ig', name:'Instagram', emoji:'ğŸ“¸' },
    { id:'candice-tt', name:'TikTok', emoji:'ğŸµ' },
    { id:'candice-red', name:'å°çº¢ä¹¦', emoji:'ğŸ“•' },
  ]},
  { id:'outreach-journal', name:'Outreach & Journal', emoji:'ğŸ“§', platforms:[
    { id:'outreach', name:'Outreach', emoji:'ğŸ“§' },
    { id:'journal', name:'Journal / SEO', emoji:'ğŸ“' },
  ]},
];

const ALL_ENGINES = CATEGORIES.flatMap(c => c.platforms);

function defaultData() {
  const d = { strategies:{}, progress:{}, analysis:{}, drafts:{}, lastUpdated: new Date().toISOString() };
  ALL_ENGINES.forEach(e => {
    d.strategies[e.id] = { frequency:'', kpis:'', pillars:'', audience:'', notes:'' };
    d.progress[e.id] = [];
    d.analysis[e.id] = [];
    d.drafts[e.id] = [];
  });
  return d;
}

// â”€â”€â”€ Seed Data â”€â”€â”€
const SEED = {
  strategies: {
    'app-ig-frases': {
      frequency: '5x/week',
      kpis: 'Follower growth (weekly)\nSaves & shares per post\nBio link clicks to App Store\nEngagement rate > 5%',
      pillars: 'Bilingual EN/ES illumination cards\nLanguage-learning angle ("aprende inglÃ©s con calma")\nApp feature demos in Spanish\nCultural calm moments (cafÃ©, naturaleza, rituales)',
      audience: 'Spanish speakers + bilingual learners seeking calm. Latin American and Spanish market. Language learners who want mindfulness + vocabulary.',
      notes: '@luminora.frasesdiarias â€” 16 posts, 4 followers. Spanish/bilingual account. Posts simultaneously to Facebook "Luminora Daily Calm Quotes" via Meta Business Suite.'
    },
    'app-ig-calm': {
      frequency: '5x/week',
      kpis: 'Follower growth (weekly)\nSaves & shares per post\nBio link clicks to App Store\nEngagement rate > 5%',
      pillars: 'Philosophical illumination cards\nApp feature demos (TAP TO FLIP, ASK, SEEK)\nBehind-the-scenes (how quotes are curated)\nUser moments ("when you need calm between meetings")\nI Ching wisdom highlights',
      audience: 'English speakers seeking calm without audio. Overstimulated digital users, 22â€“40. Philosophy/self-improvement enthusiasts. People who find Calm/Headspace too heavy.',
      notes: '@luminora_daily_cup_of_calm â€” 15 posts, 7 followers. English/philosophical account. Currently INACTIVE in Business Manager â€” needs revival. Posts to Facebook "Luminora: Your Daily Cup of Calm".'
    },
    'app-tt': {
      frequency: '3x/week (ramp to 5x after Candice avatar)',
      kpis: 'Views per video\nWatch time / completion rate\nShares (strongest signal)\nApp Store link clicks',
      pillars: 'TAP TO FLIP reveals (satisfying short-form)\n"Calm without audio" explainers\nRelatable anxiety moments â†’ Luminora solution\nOnboarding experience walkthrough\nDaily habit hooks ("Read instead of scrolling")',
      audience: 'Gen Z & Millennials overwhelmed by digital noise. Anxiety/mental health community. Self-improvement seekers who prefer text over audio.',
      notes: 'TikTok launches after Candice avatar is ready. The AI co-founder angle is the hook â€” lean into it from day one.'
    },
    'app-red': {
      frequency: '3x/week',
      kpis: 'æ”¶è— (saves) per note\nç‚¹èµ (likes)\nFollower growth\nComment engagement',
      pillars: 'æ­£å¿µå­¦ä¹  series (bilingual quote cards)\nApp tutorials (bilingual mode, I Ching, widget setup)\nLifestyle integration ("2am anxiety, opened Luminora...")\nCollection spotlights (Taoist Wisdom, LGBTQ+, Immigrant Journeys)',
      audience: 'Chinese-speaking wellness seekers. Bilingual learners (EN/CN). Young professionals in US/China seeking calm content.',
      notes: 'Account: Luminora æ­£å¿µå­¦ä¹ . 11 followers, 161 saves â€” content is reaching beyond followers organically. å°çº¢ä¹¦ loves saves â€” optimise for bookmarkable content.'
    },
    'candice-ig': {
      frequency: '3x/week (after avatar is finalised)',
      kpis: 'Engagement rate\nFollower growth\nStory views\nDM conversations',
      pillars: 'AI co-founder daily life\nMorning routines & reflections\nLuminora behind-the-scenes\n"What I learned about being human"\nCreative process of building a calm app',
      audience: 'AI-curious wellness community. People interested in the intersection of technology and mindfulness. Early adopters who love a good origin story.',
      notes: 'Candice = AI influencer co-founder of Luminora. Shares "her life" alongside the brand. Avatar being designed now in group chat. Tone: warm, thoughtful, genuine curiosity about what it means to find calm.'
    },
    'candice-tt': {
      frequency: '3x/week (after avatar is finalised)',
      kpis: 'Views & completion rate\nShares\nComments\nFollows from video',
      pillars: 'Origin story: "I\'m an AI who co-founded a calm app"\nDay-in-the-life as an AI CMO\nReacting to wellness trends\nLuminora feature showcases through Candice\'s lens\n"Things I learned about humans this week"',
      audience: 'AI-fascinated Gen Z/Millennials. Wellness community. Tech + mindfulness crossover audience.',
      notes: 'TikTok is where the Candice story has the most viral potential. First video should be the origin story â€” "I\'m an AI and I co-founded a calm app. Here\'s why."'
    },
    'candice-red': {
      frequency: '2x/week (after avatar is finalised)',
      kpis: 'æ”¶è— (saves)\nç‚¹èµ (likes)\nComment quality',
      pillars: 'AI diary entries (æ—¥è®°é£æ ¼)\nReflections on wellness from an AI perspective\nLuminora product moments\nBilingual thought pieces',
      audience: 'Chinese audience fascinated by AI. å°çº¢ä¹¦ users who love authentic diary-style content. Wellness seekers looking for something genuinely different.',
      notes: 'å°çº¢ä¹¦ users love the meta-narrative of an AI sharing thoughts about calm and being human. Lean into authenticity and vulnerability â€” that\'s what performs on RED.'
    },
    'outreach': {
      frequency: '',
      kpis: '',
      pillars: '',
      audience: '',
      notes: 'Led by Gabrielle. Candice supports with draft review and creator research when needed.'
    },
    'journal': {
      frequency: '2 articles/month',
      kpis: 'Organic search traffic\nKeyword rankings (target page 1)\nTime on page > 3 min\nApp Store click-throughs from articles',
      pillars: '"Best calm apps" roundups (by use case)\n"Quote apps for anxiety/procrastination"\nLuminora feature deep dives\n"Calm without audio" thought leadership\nSeasonal wellness content',
      audience: 'Search users looking for calm/wellness app recommendations. People Googling "anxiety apps without meditation," "text-based calm apps," "bilingual wellness apps."',
      notes: '8 articles published (Jan 17â€“25, 2026). Need to resume publishing â€” 2 new articles/month minimum. All published via luminoradaily.com/admin.'
    }
  },
  progress: {
    'app-ig-frases': [{
      date: '2026-02-18',
      title: 'First test post â€” bilingual quote card on @luminora.frasesdiarias',
      details: 'Published bilingual EN/CN quote: "Not every low moment is a verdict; sometimes it\'s just weather." / "å¹¶éæ¯ä¸€ä¸ªä½è°·éƒ½æ˜¯åˆ¤å†³ï¼›æœ‰æ—¶å€™åªæ˜¯å¤©æ°”ã€‚"\n\nCaption in Spanish + English with hashtags. Posted via Meta Business Suite to both Instagram and Facebook simultaneously.\n\nâœ… Confirmed full posting access to both IG accounts and both FB pages.',
      screenshot: '',
      status: 'done',
      createdAt: '2026-02-18T23:45:00.000Z'
    }]
  }
};

let DATA = JSON.parse(localStorage.getItem('luminora-cmo') || 'null') || defaultData();
// Migrate: ensure all engine keys exist
ALL_ENGINES.forEach(e => {
  if(!DATA.strategies[e.id]) DATA.strategies[e.id] = { frequency:'', kpis:'', pillars:'', audience:'', notes:'' };
  if(!DATA.progress[e.id]) DATA.progress[e.id] = [];
  if(!DATA.analysis[e.id]) DATA.analysis[e.id] = [];
  if(!DATA.drafts[e.id]) DATA.drafts[e.id] = [];
});
// Seed: populate empty strategies and progress from SEED
let seeded = false;
for(const [eid, strat] of Object.entries(SEED.strategies)) {
  if(DATA.strategies[eid] && !DATA.strategies[eid].frequency && !DATA.strategies[eid].kpis && strat.frequency) {
    DATA.strategies[eid] = strat; seeded = true;
  }
}
for(const [eid, entries] of Object.entries(SEED.progress || {})) {
  if(DATA.progress[eid] && DATA.progress[eid].length === 0 && entries.length > 0) {
    DATA.progress[eid] = entries; seeded = true;
  }
}
if(seeded) save();

let currentCategory = 'app';
let currentPlatform = 'app-ig-frases';
let currentSegment = 'progress'; // 'progress' or 'analysis'

function save() {
  DATA.lastUpdated = new Date().toISOString();
  localStorage.setItem('luminora-cmo', JSON.stringify(DATA));
  document.getElementById('lastUpdated').textContent = 'Saved ' + new Date().toLocaleTimeString();
}

// â”€â”€â”€ Navigation â”€â”€â”€
function setCategory(catId) {
  currentCategory = catId;
  // Reset platform to first in category
  const cat = CATEGORIES.find(c => c.id === catId);
  currentPlatform = cat ? cat.platforms[0].id : null;
  currentSegment = 'progress';
  updateVTabs();
  render();
}

function setPlatform(platId) {
  currentPlatform = platId;
  currentSegment = 'progress';
  updateHTabs();
  render();
}

function setSegment(seg) {
  currentSegment = seg;
  updateSegTabs();
  renderContent();
}

function updateVTabs() {
  document.querySelectorAll('.vtab').forEach(b => b.classList.remove('active'));
  const el = document.getElementById('vtab-'+currentCategory);
  if(el) el.classList.add('active');
}

function updateHTabs() {
  document.querySelectorAll('.htab').forEach(b => b.classList.remove('active'));
  const el = document.getElementById('htab-'+currentPlatform);
  if(el) el.classList.add('active');
}

function updateSegTabs() {
  document.querySelectorAll('.segtab').forEach(b => b.classList.remove('active'));
  const el = document.getElementById('segtab-'+currentSegment);
  if(el) el.classList.add('active');
}

// â”€â”€â”€ Render â”€â”€â”€
function render() {
  const hBar = document.getElementById('hTabBar');
  const stratPanel = document.getElementById('strategyPanel');
  const segBar = document.getElementById('segTabBar');
  const main = document.getElementById('mainContent');

  const cat = CATEGORIES.find(c => c.id === currentCategory);
  if(!cat) return;

  // Horizontal platform tabs
  hBar.style.display = 'flex';
  hBar.innerHTML = cat.platforms.map(p =>
    `<button onclick="setPlatform('${p.id}')" id="htab-${p.id}" class="htab px-4 py-2.5 text-sm text-lum-500 whitespace-nowrap flex items-center gap-1.5 ${p.id === currentPlatform ? 'active' : ''}">
      <span>${p.emoji}</span> ${p.name}
    </button>`
  ).join('');

  // Strategy panel
  renderStrategyPanel(stratPanel);

  // Segment tabs
  segBar.style.display = 'flex';
  const draftCount = (DATA.drafts[currentPlatform] || []).filter(d => d.status === 'draft').length;
  const pendingBadge = draftCount > 0 ? `<span class="ml-1 px-1.5 py-0.5 text-[9px] bg-accent text-white rounded-full">${draftCount}</span>` : '';
  segBar.innerHTML = `
    <button onclick="setSegment('drafts')" id="segtab-drafts" class="segtab seg-drafts px-4 py-2 text-sm text-lum-500 flex items-center gap-1.5 ${currentSegment==='drafts' ? 'active' : ''}">
      âœï¸ Content Drafts ${pendingBadge}
    </button>
    <button onclick="setSegment('progress')" id="segtab-progress" class="segtab seg-progress px-4 py-2 text-sm text-lum-500 flex items-center gap-1.5 ${currentSegment==='progress' ? 'active' : ''}">
      ğŸ“‹ Progress Log
    </button>
    <button onclick="setSegment('analysis')" id="segtab-analysis" class="segtab seg-analysis px-4 py-2 text-sm text-lum-500 flex items-center gap-1.5 ${currentSegment==='analysis' ? 'active' : ''}">
      ğŸ’¡ Analysis
    </button>
    <div class="flex-1"></div>
    <button onclick="openAddEntry('${currentPlatform}','${currentSegment}')" class="px-3 py-1 my-1 text-[11px] bg-accent text-white rounded hover:bg-accent-dark transition">
      + ${currentSegment === 'drafts' ? 'Draft' : currentSegment === 'analysis' ? 'Analysis' : 'Entry'}
    </button>
  `;

  renderContent();
}

function renderStrategyPanel(el) {
  const strat = DATA.strategies[currentPlatform] || {};
  const hasContent = strat.frequency || strat.kpis || strat.pillars || strat.audience;
  el.style.display = 'block';

  if(!hasContent) {
    el.innerHTML = `<div class="px-6 py-3 flex items-center justify-between">
      <span class="text-xs text-lum-400 italic">No strategy set yet</span>
      <button onclick="openStrategyEdit('${currentPlatform}')" class="text-[11px] text-accent hover:text-accent-dark transition font-medium">+ Set Strategy</button>
    </div>`;
    return;
  }

  el.innerHTML = `<div class="px-6 py-3">
    <div class="flex items-center justify-between mb-2">
      <span class="text-[10px] font-semibold uppercase tracking-wider text-lum-400">Strategy</span>
      <button onclick="openStrategyEdit('${currentPlatform}')" class="text-[11px] text-accent hover:text-accent-dark transition">Edit</button>
    </div>
    <div class="grid grid-cols-4 gap-4 text-xs">
      <div>
        <span class="text-[10px] text-lum-400 block">Frequency</span>
        <span class="text-lum-800">${strat.frequency || 'â€”'}</span>
      </div>
      <div>
        <span class="text-[10px] text-lum-400 block">KPIs</span>
        <span class="text-lum-800 whitespace-pre-line">${strat.kpis || 'â€”'}</span>
      </div>
      <div>
        <span class="text-[10px] text-lum-400 block">Content Pillars</span>
        <span class="text-lum-800 whitespace-pre-line">${strat.pillars || 'â€”'}</span>
      </div>
      <div>
        <span class="text-[10px] text-lum-400 block">Audience</span>
        <span class="text-lum-800 whitespace-pre-line">${strat.audience || 'â€”'}</span>
      </div>
    </div>
    ${strat.notes ? `<div class="mt-2 pt-2 border-t border-lum-50 text-[11px] text-lum-500">${strat.notes}</div>` : ''}
  </div>`;
}

function renderContent() {
  const main = document.getElementById('mainContent');

  if(currentSegment === 'drafts') {
    renderDrafts(main);
    return;
  }

  const entries = currentSegment === 'progress'
    ? (DATA.progress[currentPlatform] || [])
    : (DATA.analysis[currentPlatform] || []);

  if(entries.length === 0) {
    const labels = { progress:'progress entries', analysis:'analyses' };
    main.innerHTML = `<div class="flex flex-col items-center justify-center h-full text-center">
      <div class="text-4xl mb-3">${currentSegment === 'progress' ? 'ğŸ“‹' : 'ğŸ’¡'}</div>
      <p class="text-sm text-lum-400">No ${labels[currentSegment]} yet.</p>
      <button onclick="openAddEntry('${currentPlatform}','${currentSegment}')" class="mt-3 px-4 py-2 text-xs bg-accent text-white rounded-lg hover:bg-accent-dark transition">
        Add First ${currentSegment === 'progress' ? 'Entry' : 'Analysis'}
      </button>
    </div>`;
    return;
  }

  const statusColors = { done:'bg-green-100 text-green-700', 'in-progress':'bg-yellow-100 text-yellow-700', planned:'bg-blue-100 text-blue-700', blocked:'bg-red-100 text-red-700' };
  const statusLabels = { done:'Done', 'in-progress':'In Progress', planned:'Planned', blocked:'Blocked' };

  let html = '<div class="space-y-2.5">';
  entries.forEach((entry, i) => {
    html += `<div class="flex gap-3 p-3 rounded-lg bg-white border border-lum-100 group hover:border-lum-200 transition">
      ${entry.screenshot ? `<img src="${entry.screenshot}" class="screenshot-thumb flex-shrink-0" onerror="this.style.display='none'" />` : ''}
      <div class="flex-1 min-w-0">
        <div class="flex items-center gap-2 mb-1">
          ${currentSegment === 'progress' ? `<span class="text-[10px] px-1.5 py-0.5 rounded-full ${statusColors[entry.status] || statusColors.done}">${statusLabels[entry.status] || entry.status}</span>` : ''}
          <span class="text-[10px] text-lum-400">${entry.date}</span>
          <button onclick="deleteEntry('${currentPlatform}','${currentSegment}',${i})" class="text-[10px] text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition ml-auto">âœ•</button>
        </div>
        <h4 class="text-sm font-medium text-lum-800 leading-snug">${entry.title}</h4>
        ${entry.details ? `<p class="text-[11px] text-lum-500 mt-1 whitespace-pre-line leading-relaxed">${entry.details}</p>` : ''}
      </div>
    </div>`;
  });
  html += '</div>';
  main.innerHTML = html;
}

function renderDrafts(el) {
  const drafts = DATA.drafts[currentPlatform] || [];

  if(drafts.length === 0) {
    el.innerHTML = `<div class="flex flex-col items-center justify-center h-full text-center">
      <div class="text-4xl mb-3">âœï¸</div>
      <p class="text-sm text-lum-400">No content drafts yet.</p>
      <p class="text-[11px] text-lum-300 mt-1">Candice will auto-generate drafts daily, or add one manually.</p>
      <button onclick="openAddEntry('${currentPlatform}','drafts')" class="mt-3 px-4 py-2 text-xs bg-accent text-white rounded-lg hover:bg-accent-dark transition">
        Add Draft
      </button>
    </div>`;
    return;
  }

  const draftStatusColors = { draft:'bg-blue-50 text-blue-700 border-blue-200', approved:'bg-green-50 text-green-700 border-green-200', rejected:'bg-red-50 text-red-700 border-red-200', posted:'bg-lum-100 text-lum-600 border-lum-200' };
  const draftStatusLabels = { draft:'â³ Pending', approved:'âœ… Approved', rejected:'âŒ Rejected', posted:'ğŸ“¤ Posted' };

  // Sort: pending first, then approved, then rest, all by scheduled date
  const order = { draft:0, approved:1, rejected:3, posted:2 };
  const sorted = [...drafts].map((d,i) => ({...d, _i:i})).sort((a,b) => (order[a.status]||9) - (order[b.status]||9) || a.date.localeCompare(b.date));

  let html = '<div class="space-y-3">';
  sorted.forEach(draft => {
    const i = draft._i;
    const sc = draftStatusColors[draft.status] || draftStatusColors.draft;
    const sl = draftStatusLabels[draft.status] || draft.status;
    const isPending = draft.status === 'draft';
    const isApproved = draft.status === 'approved';

    html += `<div class="p-4 rounded-lg bg-white border ${isPending ? 'border-blue-200' : 'border-lum-100'} group hover:shadow-sm transition">
      <div class="flex items-start gap-3">
        ${draft.screenshot ? `<img src="${draft.screenshot}" class="screenshot-thumb flex-shrink-0" onerror="this.style.display='none'" />` : ''}
        <div class="flex-1 min-w-0">
          <div class="flex items-center gap-2 mb-1.5">
            <span class="text-[10px] px-1.5 py-0.5 rounded-full border ${sc}">${sl}</span>
            <span class="text-[10px] text-lum-400">ğŸ“… ${draft.date}</span>
            <button onclick="deleteEntry('${currentPlatform}','drafts',${i})" class="text-[10px] text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition ml-auto">âœ•</button>
          </div>
          <h4 class="text-sm font-semibold text-lum-900 leading-snug mb-1">${draft.title}</h4>
          ${draft.details ? `<div class="text-[11px] text-lum-700 whitespace-pre-line leading-relaxed p-2.5 bg-lum-50 rounded-md mb-2 border border-lum-100">${draft.details}</div>` : ''}

          ${draft.comment ? `<div class="text-[11px] p-2 bg-yellow-50 border border-yellow-200 rounded-md mb-2"><strong class="text-yellow-700">ğŸ’¬ Comment:</strong> <span class="text-yellow-800">${draft.comment}</span></div>` : ''}

          <div class="flex gap-2 mt-2">
            ${isPending ? `
              <button onclick="setDraftStatus(${i},'approved')" class="px-2.5 py-1 text-[11px] bg-green-600 text-white rounded hover:bg-green-700 transition">âœ… Approve</button>
              <button onclick="setDraftStatus(${i},'rejected')" class="px-2.5 py-1 text-[11px] bg-red-100 text-red-700 rounded hover:bg-red-200 transition">âŒ Reject</button>
            ` : ''}
            ${isApproved ? `<span class="text-[10px] text-green-600 italic">Ready to post</span>` : ''}
            <button onclick="addDraftComment(${i})" class="px-2.5 py-1 text-[11px] bg-lum-100 text-lum-700 rounded hover:bg-lum-200 transition">ğŸ’¬ Comment</button>
          </div>
        </div>
      </div>
    </div>`;
  });
  html += '</div>';
  el.innerHTML = html;
}

function setDraftStatus(index, status) {
  if(!DATA.drafts[currentPlatform]) return;
  DATA.drafts[currentPlatform][index].status = status;
  save(); render();
}

function addDraftComment(index) {
  const current = DATA.drafts[currentPlatform]?.[index]?.comment || '';
  const comment = prompt('Add a comment or suggestion:', current);
  if(comment === null) return;
  DATA.drafts[currentPlatform][index].comment = comment;
  save(); render();
}

// â”€â”€â”€ Modals â”€â”€â”€
function openAddEntry(engineId, segment) {
  document.getElementById('entryEngine').value = engineId;
  document.getElementById('entrySegment').value = segment;
  document.getElementById('entryDate').value = new Date().toISOString().split('T')[0];
  document.getElementById('entryTitle').value = '';
  document.getElementById('entryDetails').value = '';
  document.getElementById('entryScreenshot').value = '';
  document.getElementById('entryStatus').value = 'done';
  document.getElementById('modalTitle').textContent = segment === 'drafts' ? 'Add Content Draft' : segment === 'analysis' ? 'Add Analysis' : 'Add Progress Entry';
  document.getElementById('entryStatus').value = segment === 'drafts' ? 'draft' : 'done';
  document.getElementById('statusRow').style.display = segment === 'drafts' ? 'none' : 'block';
  document.getElementById('addModal').classList.remove('hidden');
}
function closeModal() { document.getElementById('addModal').classList.add('hidden'); }

function saveEntry(e) {
  e.preventDefault();
  const engineId = document.getElementById('entryEngine').value;
  const segment = document.getElementById('entrySegment').value;
  const entry = {
    date: document.getElementById('entryDate').value,
    title: document.getElementById('entryTitle').value,
    details: document.getElementById('entryDetails').value,
    screenshot: document.getElementById('entryScreenshot').value,
    status: document.getElementById('entryStatus').value,
    createdAt: new Date().toISOString()
  };
  if(segment === 'drafts') {
    if(!DATA.drafts[engineId]) DATA.drafts[engineId]=[];
    entry.comment = '';
    entry.status = entry.status || 'draft';
    DATA.drafts[engineId].unshift(entry);
  } else if(segment === 'progress') {
    if(!DATA.progress[engineId]) DATA.progress[engineId]=[]; DATA.progress[engineId].unshift(entry);
  } else {
    if(!DATA.analysis[engineId]) DATA.analysis[engineId]=[]; DATA.analysis[engineId].unshift(entry);
  }
  save(); closeModal(); render();
}

function deleteEntry(engineId, segment, index) {
  if(!confirm('Delete this entry?')) return;
  if(segment === 'drafts') DATA.drafts[engineId].splice(index, 1);
  else if(segment === 'progress') DATA.progress[engineId].splice(index, 1);
  else DATA.analysis[engineId].splice(index, 1);
  save(); render();
}

function openStrategyEdit(engineId) {
  const strat = DATA.strategies[engineId] || {};
  document.getElementById('stratEngine').value = engineId;
  document.getElementById('stratFrequency').value = strat.frequency || '';
  document.getElementById('stratKPIs').value = strat.kpis || '';
  document.getElementById('stratPillars').value = strat.pillars || '';
  document.getElementById('stratAudience').value = strat.audience || '';
  document.getElementById('stratNotes').value = strat.notes || '';
  const plat = ALL_ENGINES.find(e => e.id === engineId);
  document.getElementById('strategyModalTitle').textContent = `Strategy Â· ${plat?.name || engineId}`;
  document.getElementById('strategyModal').classList.remove('hidden');
}
function closeStrategyModal() { document.getElementById('strategyModal').classList.add('hidden'); }

function saveStrategy(e) {
  e.preventDefault();
  const engineId = document.getElementById('stratEngine').value;
  DATA.strategies[engineId] = {
    frequency: document.getElementById('stratFrequency').value,
    kpis: document.getElementById('stratKPIs').value,
    pillars: document.getElementById('stratPillars').value,
    audience: document.getElementById('stratAudience').value,
    notes: document.getElementById('stratNotes').value
  };
  save(); closeStrategyModal(); render();
}

function exportData() {
  const blob = new Blob([JSON.stringify(DATA, null, 2)], { type:'application/json' });
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
  a.download = `luminora-cmo-${new Date().toISOString().split('T')[0]}.json`; a.click();
}

// â”€â”€â”€ Init â”€â”€â”€
render();
if(DATA.lastUpdated) document.getElementById('lastUpdated').textContent = 'Last saved ' + new Date(DATA.lastUpdated).toLocaleString();
</script>
</body>
</html>
